{"version":3,"sources":["components/Terminals.jsx","warning.svg","components/DlMap.jsx","components/UseDebounced.js","components/App.js","index.js"],"names":["Button","styled","div","Wrap","Name","Phone","Wortable","Terminals","selectTerminal","pointCoords","balloonClickHandler","e","element","target","classList","contains","dataset","lat","lon","address","useEffect","document","addEventListener","removeEventListener","terminals","length","map","item","key","id","terminal","latitude","longitude","terminalSelected","modules","geometry","properties","hintContent","city","balloonContentBody","ReactDOMServer","renderToStaticMarkup","name","terminalAddress","show_phones","i","worktables","work_hours","data-address","data-lat","data-lon","className","options","preset","iconColor","_extends","Object","assign","arguments","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","createElement","fill","d","_ref","svgRef","title","props","x","y","viewBox","style","enableBackground","xmlSpace","ref","ForwardRef","forwardRef","MapWrap","InpWrap","Input","input","Options","Option","manual","TerminalMesg","ErrMesg","API_ADDRESSATOR","DlMap","setToast","browserGeo","useRef","useState","setPointCoords","pointAddress","setPointAddress","manulaInp","setManualInp","mapRef","setMapRef","ymaps","setYmaps","pointRef","setPointRef","isTerminal","setIsTerminal","value","setValue","setOptions","showError","setShowError","fetchAddress","val","clean","fetch","Array","isArray","join","current","then","r","json","checkAddress","res","hasCity","data","property","components","find","kind","hasHouse","invalid","validity","debouncedFetchAddress","func","delay","args","clearTimeout","setTimeout","UseDebouncedFunc","opts","books","includes","push","result","kladr_id","catch","err","console","log","setPoint","coords","geolocation","get","mapStateAutoApply","geoObjects","position","setCenter","balloon","close","query","apikey","process","onChange","type","placeholder","onClick","opt","point","split","selectOption","onLoad","width","height","defaultState","center","zoom","suppressMapOpenBlock","instanceRef","onDragend","getCoordinates","draggable","balloonContent","Toast","App","toast","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.598f2b4b.chunk.js","sourcesContent":["import React, { useEffect, Fragment } from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport terminals from '../contacts.json';\nimport { Placemark } from 'react-yandex-maps';\nimport styled from 'styled-components';\n\nconst Button = styled.div`\n  padding: 5px 10px;\n  text-align: center;\n  background: #f38a69;\n  color: #ffffff;\n  border-radius: 3px;\n  cursor: pointer;\n  margin-top: 10px;\n  &:hover {\n    background: #e07f61;\n  }\n`;\n\nconst Wrap = styled.div`\n  width: 260px;\n`;\n\nconst Name = styled.div`\n  margin-bottom: 10px;\n`;\n\nconst Phone = styled.div`\n  font-weight: bold;\n  margin-top: 5px;\n`;\n\nconst Wortable = styled.div`\n  margin-top: 5px;\n`;\n\nconst Terminals = ({ selectTerminal, pointCoords }) => {\n  const balloonClickHandler = (e) => {\n    const element = e.target;\n\n    if (element.classList.contains('select-terminal')) {\n      const { lat, lon, address } = element.dataset;\n      selectTerminal([lat, lon], address);\n    }\n  }\n\n  const terminalSelected = item => {\n    return pointCoords && +pointCoords[0] === item.terminal.latitude && +pointCoords[1] === item.terminal.longitude;\n  }\n\n  useEffect(() => {\n    document.addEventListener('click', balloonClickHandler);\n    return () => document.removeEventListener('click', balloonClickHandler);\n  }, []);\n\n  if (!terminals || !terminals.length) return '';\n\n  return (\n    <>{\n      terminals.map((item) => (\n        <Fragment key={item.id}>\n          {\n            !terminalSelected(item) ? (<Placemark\n              key={item.id}\n              modules={['geoObject.addon.balloon', 'geoObject.addon.hint']}\n              geometry={[item.terminal.latitude, item.terminal.longitude]}\n              properties={{\n                hintContent: `${item.city} ${item.address}`,\n                balloonContentBody: ReactDOMServer.renderToStaticMarkup(\n                  <Wrap>\n                    <b>г. {item.city}</b><br />\n                    <Name>Название терминала: {item.name}</Name>\n                    {item.terminal.terminalAddress}\n                    {item.show_phones && item.show_phones.length \n                      ? item.show_phones.map((item, i) => <Phone key={i}>{item}</Phone>)\n                      : ''}\n                    {item.worktables && item.worktables[0] && item.worktables[0].work_hours\n                      ? (<Wortable>Режим работы: <b>{item.worktables[0].work_hours}</b></Wortable>)\n                      : ''}\n                    <Button\n                      data-address={item.terminal.terminalAddress}\n                      data-lat={item.terminal.latitude}\n                      data-lon={item.terminal.longitude}\n                      className=\"select-terminal\"\n                    >\n                      Выбрать\n                    </Button>\n                  </Wrap>,\n                ),\n              }}\n              options={{\n                preset: 'islands#dotIcon',\n                iconColor: '#e84d6f',\n              }}\n            />) : ''\n          }\n        </Fragment>\n      ))\n    }</>\n  )\n};\n\nexport default Terminals;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"#638844\",\n  d: \"M243.225,333.382c-13.6,0-25,11.4-25,25s11.4,25,25,25c13.1,0,25-11.4,24.4-24.4 C268.225,344.682,256.925,333.382,243.225,333.382z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"#638844\",\n  d: \"M474.625,421.982c15.7-27.1,15.8-59.4,0.2-86.4l-156.6-271.2c-15.5-27.3-43.5-43.5-74.9-43.5s-59.4,16.3-74.9,43.4 l-156.8,271.5c-15.6,27.3-15.5,59.8,0.3,86.9c15.6,26.8,43.5,42.9,74.7,42.9h312.8 C430.725,465.582,458.825,449.282,474.625,421.982z M440.625,402.382c-8.7,15-24.1,23.9-41.3,23.9h-312.8 c-17,0-32.3-8.7-40.8-23.4c-8.6-14.9-8.7-32.7-0.1-47.7l156.8-271.4c8.5-14.9,23.7-23.7,40.9-23.7c17.1,0,32.4,8.9,40.9,23.8 l156.7,271.4C449.325,369.882,449.225,387.482,440.625,402.382z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"#638844\",\n  d: \"M237.025,157.882c-11.9,3.4-19.3,14.2-19.3,27.3c0.6,7.9,1.1,15.9,1.7,23.8c1.7,30.1,3.4,59.6,5.1,89.7 c0.6,10.2,8.5,17.6,18.7,17.6c10.2,0,18.2-7.9,18.7-18.2c0-6.2,0-11.9,0.6-18.2c1.1-19.3,2.3-38.6,3.4-57.9 c0.6-12.5,1.7-25,2.3-37.5c0-4.5-0.6-8.5-2.3-12.5C260.825,160.782,248.925,155.082,237.025,157.882z\"\n})));\n\nvar SvgWarning = function SvgWarning(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Capa_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 486.463 486.463\",\n    style: {\n      enableBackground: \"new 0 0 486.463 486.463\"\n    },\n    xmlSpace: \"preserve\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgWarning, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/warning.b9aa2a80.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useState, useEffect, useRef } from 'react';\nimport { YMaps, Map, GeolocationControl, ZoomControl, Placemark } from 'react-yandex-maps';\nimport styled from 'styled-components';\nimport Terminals from './Terminals';\nimport UseDebouncedFunc from './UseDebounced';\nimport { ReactComponent as Warning } from '../warning.svg'\n\nconst MapWrap = styled.div`\n  overflow: hidden;\n  border-radius: 3px;\n  box-shadow: 0px 1px 10px rgba(0,0,0,0.3);\n  position: relative;\n`;\n\nconst InpWrap = styled.div`\n  position: relative;\n  margin-bottom: 40px;\n`;\n\nconst Input = styled.input`\n  box-sizing: border-box;\n  width: 100%;\n  border: 1px solid #D6D6D6;\n  box-shadow: 0 1px 5px rgba(0,0,0,0.1);\n  border-radius: 4px;\n  outline: none;\n  padding: 10px 20px;\n  font-size: 16px;\n  background: transparent;\n`;\n\nconst Options = styled.div`\n  overflow-y: auto;\n  max-height: 200px;\n  top: 100%;\n  left: 5px;\n  right: 5px;\n  background: #ffffff;\n  position: absolute;\n  z-index: 3;\n  box-shadow: 0 1px 5px rgba(0,0,0,0.1);\n  margin-top: 10px;\n  border-radius: 2px;\n`;\n\nconst Option = styled.div`\n  padding: 5px;\n  font-size: 14px;\n  cursor: pointer;\n  ${({ manual }) => (manual ? 'color: green;' : '')}\n  &:hover {\n    background: #f7f7f7;\n  }\n`;\n\nconst TerminalMesg = styled.div`\n  position: absolute;\n  top: 100%;\n  left: 10px;\n  right: 10px;\n  padding-left: 3px;\n  font-size: 14px;\n  padding-top: 4px;\n  color: #638844;\n  svg {\n    margin-top: -2px;\n    display: block;\n    width: 20px;\n    float: left;\n    margin-right: 6px;\n  }\n`;\n\nconst ErrMesg = styled.div`\n  border-radius: 2px;\n  margin-top: 5px;\n  padding: 5px 10px;\n  font-size: 14px;\n  background: #e02626;\n  color: #ffffff;\n  position: absolute;\n  top: 100%;\n  left: 10px;\n  svg {\n    margin-top: -2px;\n    display: block;\n    width: 20px;\n    float: left;\n    margin-right: 6px;\n    path {\n      fill: #ffffff;\n    }\n  }\n`;\n\nconst API_KEY_YMAPS = process.env.REACT_APP_MAP_API_KEY;\nconst BASE_URL = process.env.NODE_ENV === 'development' ? '' : 'https://www.dellin.stage';\nconst API_ADDRESSATOR = `${BASE_URL}/api/v2/address/`;\n\nconst DlMap = ({ setToast }) => {\n  const browserGeo = useRef('');\n\n  const [pointCoords, setPointCoords] = useState([]);\n  const [pointAddress, setPointAddress] = useState('');\n\n  const [manulaInp, setManualInp] = useState(false);\n  const [mapRef, setMapRef] = useState(null);\n  const [ymaps, setYmaps] = useState(null);\n  const [pointRef, setPointRef] = useState(null);\n  const [isTerminal, setIsTerminal] = useState(false);\n\n  const [value, setValue] = useState('');\n  const [options, setOptions] = useState(null);\n  const [showError, setShowError] = useState('');\n\n  const fetchAddress = (val, options, clean) => {\n    setShowError('');\n    setIsTerminal(false);\n    return fetch(`${API_ADDRESSATOR}?query=${Array.isArray(val) ? val.join(',') : val}${options || ''}${!clean ? browserGeo.current : ''}`)\n      .then(r => r.json())\n  }\n\n  const checkAddress = (res) => {\n    const hasCity = res.data[0].property.components.find(i => i.kind === 'city');\n    const hasHouse = res.data[0].property.components.find(i => i.kind === 'house');\n    const invalid = res.data[0].property.validity === 'UNOFFICIAL_SOURCE' || res.data[0].property.validity === 'VALIDATED_HAS_UNPARSED_PARTS';\n    \n    if (invalid && hasCity) {\n      setShowError(`Ваш населенный пункт ${hasCity.name}. Цена перевозки ориентировочная`);\n    } else if (invalid && !hasCity) {\n      setShowError('Требуется уточнение возможности перевозки и цены');\n    } else if (!hasHouse) {\n      setShowError('Не указан номер дома');\n    }\n  }\n\n  const mapClick = e => setPoint(e.get('coords'));\n\n  const movePoint = () => setPoint(pointRef.geometry.getCoordinates());\n\n  const debouncedFetchAddress = UseDebouncedFunc((val) => {\n    fetchAddress(val).then(res => {\n      if (res && res.data) {\n        const opts = [...res.data];\n        if ((res.data[0] && res.data[0].books.includes('cdi_clean')) || !res.data.length) {\n          opts.push({ result: 'Нет в списке', property: { kladr_id: 'manualInp' } })\n        }\n        setOptions(opts);\n      }\n    }).catch(err => console.log('ERROR: ', err));\n  }, 300);\n\n  const onChangeHandler = (e) => {\n    const val = e.target.value;\n    setValue(val);\n    if (val) debouncedFetchAddress(val);\n  }\n\n  const selectOption = (opt) => {\n    if (opt.property.kladr_id === 'manualInp') {\n      fetchAddress(value, 'books=cdi_clean', true)\n        .then((res) => {\n          const hasCity = res.data[0].property.components.find(i => i.kind === 'city');\n          if (hasCity) {\n            setShowError(`Ваш населенный пункт ${hasCity.name}. Цена перевозки ориентировочная`);\n          } else {\n            setShowError('Требуется уточнение возможности перевозки и цены');\n          }\n        }).catch(err => console.log('ERROR: ', err));\n      setManualInp(true);\n      setOptions(null);\n      return;\n    }\n    \n    setValue(opt.result);\n    setOptions(null);\n    if (opt.books.includes('cdi_clean')) {\n      fetchAddress(opt.result, '&fields=point')\n        .then(res => {\n          if (res && res.data) {\n            const coords = res.data[0].point.split(',');\n            const address = opt.result;\n\n            setPointCoords(coords);\n            setPointAddress(address);\n            mapRef.setCenter(coords, 17);\n\n            checkAddress(res);\n          }\n        })\n        .catch(err => console.log('ERROR: ', err));\n    }\n  }\n\n  const setPoint = coords => {\n    setIsTerminal(false);\n    setPointCoords(coords);\n\n    fetchAddress(coords)\n      .then(res => {\n        if (res && res.data && res.data[0]) {\n          setValue(res.data[0].result);\n          setPointAddress(res.data[0].result);\n          checkAddress(res);\n        }\n      })\n      .catch(err => console.log('ERROR: ', err));\n  }\n\n  const selectTerminal = (coords, address) => {\n    setValue(address);\n    setIsTerminal(true);\n    setPointCoords(coords);\n    setPointAddress(address);\n  }\n\n  // Initial Postion bases on geolocation\n  useEffect(() => {\n    if (ymaps && mapRef) {\n      ymaps.geolocation.get({\n        mapStateAutoApply: true\n      })\n      .then(function(result) {\n        if (result) {\n          const coords = result.geoObjects.position;\n          browserGeo.current = `&location_priority=${coords.join(',')}`;\n          mapRef.setCenter(coords, 16);\n          setPointCoords(coords);\n          fetchAddress(coords)\n            .then(res => {\n              if (res && res.data) {\n                setValue(res.data[0].result);\n                setPointAddress(res.data[0].result);\n              }\n            })\n            .catch(err => console.log('ERROR: ', err));\n        }\n      });\n    }\n  }, [ymaps, mapRef])\n\n  useEffect(() => {\n    if (pointCoords && mapRef) mapRef.balloon.close();\n  }, [pointCoords, mapRef]);\n\n  useEffect(() => {\n    setManualInp(false);\n  }, [value]);\n\n  return (\n    <YMaps query={{ apikey: API_KEY_YMAPS }}>\n      <InpWrap>\n        <Input onChange={onChangeHandler} value={value} type=\"text\" placeholder=\"Адрес\" />\n        {isTerminal && (\n          <TerminalMesg>\n            <Warning />\n            Отправка из терминала\n          </TerminalMesg>\n        )}\n        {!isTerminal && showError && (\n          <ErrMesg>\n            <Warning />\n            {showError}\n          </ErrMesg>\n        )}\n        {options && (\n          <Options>\n            {options.map(item => (\n              <Option\n                key={item.property.kladr_id}\n                onClick={() => selectOption(item)}\n                manual={item.property.kladr_id === 'manualInp'}\n              >\n                {item.result}\n              </Option>\n            ))}\n          </Options>\n        )}\n      </InpWrap>\n      <MapWrap>\n        <Map\n          modules={['geolocation', 'geocode', 'coordSystem.geo']}\n          onLoad={setYmaps}\n          onClick={mapClick}\n          width={'100%'}\n          height={'500px'}\n          defaultState={{ center: [55.75, 37.57], zoom: 12 }}\n          options={{ suppressMapOpenBlock: true }}\n          instanceRef={setMapRef}\n        >\n          {\n            !manulaInp && pointCoords && pointCoords.length ? (\n              <Placemark\n                modules={['geoObject.addon.balloon', 'geoObject.addon.hint']}\n                onDragend={movePoint}\n                geometry={pointCoords}\n                options={{ draggable: true }}\n                properties={{\n                  hintContent: pointAddress,\n                  balloonContent: '<div style=\"width: 200px;\">' + pointAddress + '</div>'\n                }}\n                instanceRef={setPointRef}\n              />\n            ) : ''\n          }\n          <Terminals selectTerminal={selectTerminal} pointCoords={pointCoords} />\n          <ZoomControl />\n          <GeolocationControl />\n        </Map>\n      </MapWrap>\n    </YMaps>\n  )\n}\n\nexport default DlMap;","import { useRef } from 'react';\n\nexport default function useDebouncedFunction(func, delay) {\n  const ref = useRef(null);\n\n  return (...args) => {\n    clearTimeout(ref.current);\n    ref.current = setTimeout(() => func(...args), delay);\n  };\n}","import React, { useEffect, useState, useRef } from 'react';\nimport DlMap from './DlMap';\nimport styled from 'styled-components';\n\nconst Wrap = styled.div`\n  width: 800px;\n  margin: 0 auto;\n  padding: 40px 10px 100px 10px;\n`;\n\nconst Toast = styled.div`\n  width: 300px;\n  padding: 10px 20px;\n  color: #ffffff;\n  border-radius: 4px;\n  box-shadow: 0px 1px 10px rgba(0,0,0,0.3);\n  position: fixed;\n  right: 30px;\n  bottom: 30px;\n  background: #e04439;\n  z-index: 100;\n  font-size: 14px;\n\n  animation: fadeIn 0.3s ease;\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n      right: -100px;\n    }\n    to {\n      opacity: 1;\n      right: 30px;\n    }\n  }\n`;\n\nfunction App() {\n  const [toast, setToast] = useState('');\n  const ref = useRef(null);\n\n  useEffect(() => {\n    clearTimeout(ref.current);\n    ref.current = setTimeout(() => {\n      setToast(false);\n    }, 2000);\n    return () => {\n      clearTimeout(ref.current);\n    }\n  }, [toast]);\n\n  return (\n    <Wrap>\n      {toast && <Toast>{toast}</Toast>}\n      <DlMap width=\"100%\" setToast={setToast} />\n    </Wrap>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}